{"ast":null,"code":"import _objectSpread from\"/Users/akiyamashuuhei/data/ShereJob/frontend/node_modules/@babel/runtime/helpers/esm/objectSpread2.js\";import _regeneratorRuntime from\"/Users/akiyamashuuhei/data/ShereJob/frontend/node_modules/@babel/runtime/helpers/esm/regeneratorRuntime.js\";import _asyncToGenerator from\"/Users/akiyamashuuhei/data/ShereJob/frontend/node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js\";import _slicedToArray from\"/Users/akiyamashuuhei/data/ShereJob/frontend/node_modules/@babel/runtime/helpers/esm/slicedToArray.js\";import{useParams,useNavigate}from'react-router-dom';import{useState,useEffect}from'react';import CompanyDetail from'../../components/companyDetail';import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";function EditMemo(_ref){var companyList=_ref.companyList,myCompanyList=_ref.myCompanyList,updateMyCompanyList=_ref.updateMyCompanyList,handleUpdate=_ref.handleUpdate;var _useParams=useParams(),email=_useParams.email,id=_useParams.id;var navigate=useNavigate();// 対応する会社情報を探す\nvar company=companyList.find(function(info){return info.id===id;});//対応するメモを探す\nvar myCompany=myCompanyList.find(function(info){return info.id===id&&info.email===email;});var _useState=useState((myCompany===null||myCompany===void 0?void 0:myCompany.memo)||''),_useState2=_slicedToArray(_useState,2),memo=_useState2[0],setMemo=_useState2[1];var handleMemoChange=function handleMemoChange(event){setMemo(event.target.value);};/**\n\t *APIにupdateリクエストする\n\t */var handleUpdateMyCompany=/*#__PURE__*/function(){var _ref2=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee(){return _regeneratorRuntime().wrap(function _callee$(_context){while(1)switch(_context.prev=_context.next){case 0:_context.prev=0;_context.next=3;return fetch(process.env.REACT_APP_BASE_URL+\"myCompany/updateMyCompany/\".concat(email,\"/\").concat(id),{method:'PUT',headers:{'Content-Type':'application/json',authorization:\"Bearer \".concat(localStorage.getItem('token'))},body:JSON.stringify({memo:memo})});case 3:if(company){alert(\"\".concat(company.name,\"\\u306E\\u30E1\\u30E2\\u3092\\u5909\\u66F4\\u3057\\u307E\\u3057\\u305F\"));}_context.next=9;break;case 6:_context.prev=6;_context.t0=_context[\"catch\"](0);alert('更新に失敗しました');case 9:case\"end\":return _context.stop();}},_callee,null,[[0,6]]);}));return function handleUpdateMyCompany(){return _ref2.apply(this,arguments);};}();/**\n\t * メモ削除の処理をする\n\t */var handleDelete=/*#__PURE__*/function(){var _ref3=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee2(){var confirmDelete,response,jsonResponse,updatedMyCompanyList;return _regeneratorRuntime().wrap(function _callee2$(_context2){while(1)switch(_context2.prev=_context2.next){case 0:confirmDelete=window.confirm('本当にメモを削除しますか？');if(!confirmDelete){_context2.next=18;break;}_context2.prev=2;_context2.next=5;return fetch(process.env.REACT_APP_BASE_URL+\"myCompany/deleteMyCompany/\".concat(email,\"/\").concat(id),{method:'DELETE',headers:{authorization:\"Bearer \".concat(localStorage.getItem('token'))}});case 5:response=_context2.sent;_context2.next=8;return response.json();case 8:jsonResponse=_context2.sent;alert(jsonResponse.message);// 削除が成功したら、リストから削除した情報を更新する\nupdatedMyCompanyList=myCompanyList.filter(function(info){return info.id!==id;});updateMyCompanyList(updatedMyCompanyList);// 削除後にリダイレクトするならば以下の行を有効化する\nnavigate('/pages/home');_context2.next=18;break;case 15:_context2.prev=15;_context2.t0=_context2[\"catch\"](2);alert('削除に失敗しました');case 18:handleUpdate();case 19:case\"end\":return _context2.stop();}},_callee2,null,[[2,15]]);}));return function handleDelete(){return _ref3.apply(this,arguments);};}();/**\n\t *完了ボタンが押されたときの処理を実装する\n\t */var handleComplete=function handleComplete(){var updatedMyCompanyList=myCompanyList.map(function(info){if(info.email===email&&info.id===id){return _objectSpread(_objectSpread({},info),{},{memo:memo});}return info;});updateMyCompanyList(updatedMyCompanyList);handleUpdateMyCompany();//handleUpdate();\nnavigate('/pages/home');};/**\n\t * タイトルを更新する\n\t */useEffect(function(){if(company){document.title=\"\".concat(company.name,\"\\u306E\\u30E1\\u30E2\");}});return/*#__PURE__*/_jsxs(\"div\",{children:[company?/*#__PURE__*/_jsx(CompanyDetail,{company:company}):null,company?/*#__PURE__*/_jsxs(\"h2\",{children:[company.name,\"\\u306E\\u30E1\\u30E2\"]}):null,/*#__PURE__*/_jsx(\"div\",{className:\"textarea-container\",children:/*#__PURE__*/_jsx(\"textarea\",{className:\"textarea\",rows:5,value:memo,onChange:handleMemoChange})}),/*#__PURE__*/_jsx(\"button\",{onClick:handleComplete,children:\"\\u5B8C\\u4E86\"}),/*#__PURE__*/_jsx(\"button\",{onClick:handleDelete,children:\"\\u6D88\\u53BB\"})]});}export default EditMemo;","map":{"version":3,"names":["useParams","useNavigate","useState","useEffect","CompanyDetail","jsx","_jsx","jsxs","_jsxs","EditMemo","_ref","companyList","myCompanyList","updateMyCompanyList","handleUpdate","_useParams","email","id","navigate","company","find","info","myCompany","_useState","memo","_useState2","_slicedToArray","setMemo","handleMemoChange","event","target","value","handleUpdateMyCompany","_ref2","_asyncToGenerator","_regeneratorRuntime","mark","_callee","wrap","_callee$","_context","prev","next","fetch","process","env","REACT_APP_BASE_URL","concat","method","headers","authorization","localStorage","getItem","body","JSON","stringify","alert","name","t0","stop","apply","arguments","handleDelete","_ref3","_callee2","confirmDelete","response","jsonResponse","updatedMyCompanyList","_callee2$","_context2","window","confirm","sent","json","message","filter","handleComplete","map","_objectSpread","document","title","children","className","rows","onChange","onClick"],"sources":["/Users/akiyamashuuhei/data/ShereJob/frontend/src/pages/myCompany/editMemo.tsx"],"sourcesContent":["import { useParams, useNavigate } from 'react-router-dom';\nimport { useState, useEffect } from 'react';\nimport { EditMemoProps, MyCompanyType, CompanyType } from '../../utils/types';\nimport CompanyDetail from '../../components/companyDetail';\n\nfunction EditMemo({\n\tcompanyList,\n\tmyCompanyList,\n\tupdateMyCompanyList,\n\thandleUpdate,\n}: EditMemoProps) {\n\tconst { email, id } = useParams();\n\tconst navigate = useNavigate();\n\t// 対応する会社情報を探す\n\tconst company: CompanyType | undefined = companyList.find(\n\t\t(info) => info.id === id\n\t);\n\t//対応するメモを探す\n\tconst myCompany: MyCompanyType | undefined = myCompanyList.find(\n\t\t(info) => info.id === id && info.email === email\n\t);\n\n\tconst [memo, setMemo] = useState<string>(myCompany?.memo || '');\n\n\tconst handleMemoChange = (event: React.ChangeEvent<HTMLTextAreaElement>) => {\n\t\tsetMemo(event.target.value);\n\t};\n\t/**\n\t *APIにupdateリクエストする\n\t */\n\tconst handleUpdateMyCompany = async () => {\n\t\ttry {\n\t\t\tawait fetch(\n\t\t\t\tprocess.env.REACT_APP_BASE_URL! +\n\t\t\t\t\t`myCompany/updateMyCompany/${email}/${id}`,\n\t\t\t\t{\n\t\t\t\t\tmethod: 'PUT',\n\t\t\t\t\theaders: {\n\t\t\t\t\t\t'Content-Type': 'application/json',\n\t\t\t\t\t\tauthorization: `Bearer ${localStorage.getItem('token')}`,\n\t\t\t\t\t},\n\t\t\t\t\tbody: JSON.stringify({\n\t\t\t\t\t\tmemo: memo,\n\t\t\t\t\t}),\n\t\t\t\t}\n\t\t\t);\n\t\t\tif (company) {\n\t\t\t\talert(`${company.name}のメモを変更しました`);\n\t\t\t}\n\t\t} catch (err) {\n\t\t\talert('更新に失敗しました');\n\t\t}\n\t};\n\n\t/**\n\t * メモ削除の処理をする\n\t */\n\tconst handleDelete = async () => {\n\t\tconst confirmDelete = window.confirm('本当にメモを削除しますか？');\n\t\tif (confirmDelete) {\n\t\t\ttry {\n\t\t\t\tconst response = await fetch(\n\t\t\t\t\tprocess.env.REACT_APP_BASE_URL! +\n\t\t\t\t\t\t`myCompany/deleteMyCompany/${email}/${id}`,\n\n\t\t\t\t\t{\n\t\t\t\t\t\tmethod: 'DELETE',\n\t\t\t\t\t\theaders: {\n\t\t\t\t\t\t\tauthorization: `Bearer ${localStorage.getItem('token')}`,\n\t\t\t\t\t\t},\n\t\t\t\t\t}\n\t\t\t\t);\n\n\t\t\t\tconst jsonResponse = await response.json();\n\t\t\t\talert(jsonResponse.message);\n\n\t\t\t\t// 削除が成功したら、リストから削除した情報を更新する\n\t\t\t\tconst updatedMyCompanyList = myCompanyList.filter(\n\t\t\t\t\t(info) => info.id !== id\n\t\t\t\t);\n\t\t\t\tupdateMyCompanyList(updatedMyCompanyList);\n\n\t\t\t\t// 削除後にリダイレクトするならば以下の行を有効化する\n\t\t\t\tnavigate('/pages/home');\n\t\t\t} catch (err) {\n\t\t\t\talert('削除に失敗しました');\n\t\t\t}\n\t\t}\n\t\thandleUpdate();\n\t};\n\t/**\n\t *完了ボタンが押されたときの処理を実装する\n\t */\n\tconst handleComplete = () => {\n\t\tconst updatedMyCompanyList = myCompanyList.map((info) => {\n\t\t\tif (info.email === email && info.id === id) {\n\t\t\t\treturn {\n\t\t\t\t\t...info,\n\t\t\t\t\tmemo: memo,\n\t\t\t\t};\n\t\t\t}\n\t\t\treturn info;\n\t\t});\n\n\t\tupdateMyCompanyList(updatedMyCompanyList);\n\t\thandleUpdateMyCompany();\n\n\t\t//handleUpdate();\n\t\tnavigate('/pages/home');\n\t};\n\n\t/**\n\t * タイトルを更新する\n\t */\n\tuseEffect(() => {\n\t\tif (company) {\n\t\t\tdocument.title = `${company.name}のメモ`;\n\t\t}\n\t});\n\n\treturn (\n\t\t<div>\n\t\t\t{company ? <CompanyDetail company={company} /> : null}\n\t\t\t{company ? <h2>{company.name}のメモ</h2> : null}\n\t\t\t<div className=\"textarea-container\">\n\t\t\t\t<textarea\n\t\t\t\t\tclassName=\"textarea\"\n\t\t\t\t\trows={5}\n\t\t\t\t\tvalue={memo}\n\t\t\t\t\tonChange={handleMemoChange}\n\t\t\t\t/>\n\t\t\t</div>\n\t\t\t<button onClick={handleComplete}>完了</button>\n\t\t\t<button onClick={handleDelete}>消去</button>\n\t\t</div>\n\t);\n}\n\nexport default EditMemo;\n"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}